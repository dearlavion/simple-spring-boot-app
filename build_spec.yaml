version: 0.1
component: build
timeoutInSeconds: 6000
runAs: root
shell: bash

steps:
  - type: Command
    name: Install Java 11
    command: |
      echo "========== Installing OpenJDK 11 with yum =========="
      yum install -y java-11-openjdk-devel

  - type: Command
    name: Build with Maven
    command: |
      echo "========== Setting up Java 11 environment =========="
      export JAVA_HOME=/usr/lib/jvm/java-11-openjdk
      export PATH=$JAVA_HOME/bin:$PATH
      echo "JAVA_HOME is $JAVA_HOME"
      java -version

      echo "========== Running mvn clean package =========="
      mvn clean package

      echo "========== Checking contents of target/ =========="
      ls -l target/

      echo "========== Renaming target/ =========="
      cp target/simple-spring-boot-app-1.0-SNAPSHOT.jar target/baishWebServer.jar

outputArtifacts:
  - name: baishWebServer
    type: BINARY
    location: target/baishWebServer.jar